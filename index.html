<!DOCTYPE html>
<html lang="en" class="page-free-software">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Green Software Solutions</title>
	<link rel="stylesheet" href="reset.css">
	<link rel="stylesheet" href="style.css">
	<link rel="stylesheet" href="page-styles.css">
	<link rel="stylesheet" href="components/menu.css">
	
	
	<link rel="icon" href="./favicon.png" type="image/png">
	
	<style>
		/* Add keyframe animation and loader styles in the head to ensure they're always available */
		@keyframes spin {
			to { transform: rotate(360deg); }
		}
		
		.page-loader {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			display: flex;
			justify-content: center;
			align-items: center;
			z-index: 2000;
			opacity: 0;
			visibility: hidden;
			transition: opacity 0.3s ease, visibility 0.3s;
		}
		
		.page-loader.active {
			opacity: 1;
			visibility: visible;
		}
		
		.loader-spinner {
			width: 64px;
			height: 64px;
			position: relative;
		}
		
		.spinner-circle {
			width: 100%;
			height: 100%;
			border: 5px solid rgba(127, 197, 128, 0.2);
			border-top-color: rgb(21, 48, 63);
			border-radius: 50%;
			animation: spin 1s linear infinite;
		}
		
		/* Initial loading state styles */
		#logo, #menu-container, #footer, #page-content {
			opacity: 0;
			visibility: hidden;
			transition: opacity 0.5s ease, visibility 0s 0.5s;
		}
		
		/* Show UI when body has loaded class */
		body.loaded #logo, 
		body.loaded #menu-container, 
		body.loaded #footer, 
		body.loaded #page-content {
			opacity: 1;
			visibility: visible;
			transition: opacity 0.5s ease, visibility 0s;
		}
		
		/* Debug console - only shown on localhost */
		#debug-panel {
			position: fixed;
			bottom: 0;
			left: 0;
			width: 100%;
			height: 200px;
			background-color: rgba(0,0,0,0.8);
			color: #fff;
			font-family: monospace;
			font-size: 12px;
			overflow-y: auto;
			z-index: 10000;
			display: none;
			padding: 10px;
		}
		
		#debug-panel.visible {
			display: block;
		}
		
		#debug-toggle {
			position: fixed;
			bottom: 10px;
			right: 10px;
			z-index: 10001;
			background-color: rgba(0,0,0,0.7);
			color: white;
			border: none;
			padding: 5px 10px;
			border-radius: 4px;
			cursor: pointer;
			display: none; /* Hidden by default, shown only on localhost */
		}
	</style>
	
	<!-- Immediate UI hiding before any content loads -->
	<script>
		// Ensure UI is hidden on initial page load (hard reload)
		// Check if this is a fresh page load
		if (window.performance && performance.navigation.type === performance.navigation.TYPE_RELOAD || 
			!sessionStorage.getItem('initialLoadComplete')) {
			
			// First load - hide UI elements
			console.log('Initial page load detected - hiding UI until ready');
			
			// Make the loader visible right away
			document.addEventListener('DOMContentLoaded', function() {
				const loader = document.getElementById('page-loader');
				if (loader) {
					loader.classList.add('active');
				}
			}, { once: true });
			
			// Set flag for future navigation
			sessionStorage.setItem('initialLoadComplete', 'true');
		} else {
			// Not a fresh page load - loading from cache or navigation
			console.log('Page navigation or cached content - UI will remain visible');
			// For navigation, we want to keep the UI visible
			document.addEventListener('DOMContentLoaded', function() {
				document.body.classList.add('loaded');
			}, { once: true });
		}
	</script>
</head>

<body>
	<table id="content">
		<tr>
			<td id="content-cell">

				
				<!-- Logo outside of page content so it's consistent across all pages -->
				<div id="logo">
					<div class="gradient"></div>
					<div id="logo-bg"></div>
				</div>

				<div id="menu-container" style="position: relative; z-index: 2000;">
					<!-- Menu items will be generated by JavaScript -->
					<nav class="side-menu">
						<ul id="main-menu"></ul>
					</nav>
				</div>
				
				<!-- Ensure page content is below menu in z-index -->
				<div id="page-content" style="position: relative; z-index: 1;">

				</div>

				<div id="footer">
					Copyright © <span id="year"></span> Green Software Solutions OÜ
				</div>
				
				<!-- Page loader inside content cell -->
				<div id="page-loader" class="page-loader">
					<div class="loader-spinner">
						<div class="spinner-circle"></div>
					</div>
				</div>
			</td>
		</tr>
	</table>
	
	<!-- Debug console for easier troubleshooting - only shown on localhost -->
	<div id="debug-panel"></div>
	<button id="debug-toggle">Debug</button>
	
	<!-- Import JavaScript modules -->
	<script type="module" src="components/PageLoader.js"></script>
	<script type="module" src="main.js"></script>
	
	<script>
		// Debug console functionality - only enabled on localhost
		const isLocalhost = window.location.hostname === 'localhost' || 
							window.location.hostname === '127.0.0.1' ||
							window.location.hostname === '';
		
		const debugPanel = document.getElementById('debug-panel');
		const debugToggle = document.getElementById('debug-toggle');
		
		if (isLocalhost) {
			console.log('Development environment detected, enabling debug tools');
			// Show debug toggle button on localhost
			debugToggle.style.display = 'block';
			
			const originalConsoleLog = console.log;
			const originalConsoleError = console.error;
			
			// Override console.log to add to debug panel
			console.log = function() {
				// Call original console.log
				originalConsoleLog.apply(console, arguments);
				
				// Add to debug panel
				const args = Array.from(arguments);
				const message = args.map(arg => {
					if (typeof arg === 'object') {
						return JSON.stringify(arg, null, 2);
					}
					return arg;
				}).join(' ');
				
				const logLine = document.createElement('div');
				logLine.textContent = `[LOG] ${message}`;
				debugPanel.appendChild(logLine);
				debugPanel.scrollTop = debugPanel.scrollHeight;
			};
			
			// Override console.error to add to debug panel in red
			console.error = function() {
				// Call original console.error
				originalConsoleError.apply(console, arguments);
				
				// Add to debug panel
				const args = Array.from(arguments);
				const message = args.map(arg => {
					if (typeof arg === 'object') {
						return JSON.stringify(arg, null, 2);
					}
					return arg;
				}).join(' ');
				
				const logLine = document.createElement('div');
				logLine.textContent = `[ERROR] ${message}`;
				logLine.style.color = '#ff5555';
				debugPanel.appendChild(logLine);
				debugPanel.scrollTop = debugPanel.scrollHeight;
			};
			
			// Toggle debug panel
			debugToggle.addEventListener('click', function() {
				debugPanel.classList.toggle('visible');
			});
			
			console.log('Debug console initialized');
		} else {
			// Production environment: remove debug elements
			if (debugPanel) debugPanel.remove();
			if (debugToggle) debugToggle.remove();
			
			console.log('Production environment detected, debug tools disabled');
		}
	</script>
</body>

</html>